<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <actionCalls>
        <name>Minimise_flow_screen</name>
        <label>Minimise flow screen</label>
        <locationX>2294</locationX>
        <locationY>1574</locationY>
        <actionName>c:MinimizeUtilityItem</actionName>
        <actionType>component</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
    </actionCalls>
    <apiVersion>51.0</apiVersion>
    <assignments>
        <name>Assign_email_to_validate</name>
        <label>Assign email to validate</label>
        <locationX>3944</locationX>
        <locationY>398</locationY>
        <assignmentItems>
            <assignToReference>providedEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CustomerEmail.value</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_the_email_valid</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_email_to_validate_0</name>
        <label>Assign email to validate</label>
        <locationX>5330</locationX>
        <locationY>758</locationY>
        <assignmentItems>
            <assignToReference>providedEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ValidEmail.value</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Is_the_email_valid</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields1</name>
        <label>SetCaseFields1</label>
        <locationX>50</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM ARC</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields10</name>
        <label>SetCaseFields10</label>
        <locationX>2690</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>OC Error Handling</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields11</name>
        <label>SetCaseFields11</label>
        <locationX>3218</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sitel Waivers</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields12</name>
        <label>SetCaseFields12</label>
        <locationX>3482</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>OC Reserved Amount</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields13</name>
        <label>SetCaseFields13</label>
        <locationX>3746</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>OC Gift Card</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields14</name>
        <label>SetCaseFields14</label>
        <locationX>4010</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>OC Bank Transfer</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields15</name>
        <label>SetCaseFields15</label>
        <locationX>4274</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sykes Voucher</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields16</name>
        <label>SetCaseFields16</label>
        <locationX>2162</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM General</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields17</name>
        <label>SetCaseFields17</label>
        <locationX>2954</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>OC General</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields2</name>
        <label>SetCaseFields2</label>
        <locationX>314</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM BSP</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields3</name>
        <label>SetCaseFields3</label>
        <locationX>578</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM Forms Travel Agent</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields4</name>
        <label>SetCaseFields4</label>
        <locationX>842</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM Forsvaret</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields5</name>
        <label>SetCaseFields5</label>
        <locationX>1106</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM General</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields6</name>
        <label>SetCaseFields6</label>
        <locationX>1370</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>OC SC Under 180 Minutes</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields7</name>
        <label>SetCaseFields7</label>
        <locationX>1634</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sitel General</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields8</name>
        <label>SetCaseFields8</label>
        <locationX>1898</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM Error Handling</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetCaseFields9</name>
        <label>SetCaseFields9</label>
        <locationX>2426</locationX>
        <locationY>878</locationY>
        <assignmentItems>
            <assignToReference>TeamToSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BOM Error Handling</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_Request</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Is_the_email_valid</name>
        <label>Is the email valid?</label>
        <locationX>3944</locationX>
        <locationY>518</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>emailValidation</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>GetRefundsRecordType</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
        <rules>
            <name>No</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>emailValidation</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Invalid_Input</targetReference>
            </connector>
            <label>No</label>
        </rules>
    </decisions>
    <decisions>
        <name>SetTeamAndCaseReason</name>
        <label>SetTeamAndCaseReason</label>
        <locationX>2294</locationX>
        <locationY>758</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>TATicketsUSAOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Travel Agent Tickets</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>USA</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields1</targetReference>
            </connector>
            <label>TA Tickets USA</label>
        </rules>
        <rules>
            <name>TATicketsChinaEURoWOutcome</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Travel Agent Tickets</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>China</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Europe &amp; Rest of World</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields2</targetReference>
            </connector>
            <label>TA Tickets China/EU&amp;RoW</label>
        </rules>
        <rules>
            <name>TATicketsWebformOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Travel Agent Tickets</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Webform Request</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields3</targetReference>
            </connector>
            <label>TA Tickets Webform</label>
        </rules>
        <rules>
            <name>ForsvaretOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Other</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Forsvaret</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields4</targetReference>
            </connector>
            <label>Forsvaret</label>
        </rules>
        <rules>
            <name>X24hourOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Other</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>24 hour</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields5</targetReference>
            </connector>
            <label>24 hour</label>
        </rules>
        <rules>
            <name>SCunder180minOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Other</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SC under 180 min</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields6</targetReference>
            </connector>
            <label>SC under 180 min</label>
        </rules>
        <rules>
            <name>OtherOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Other</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Other</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields7</targetReference>
            </connector>
            <label>Other</label>
        </rules>
        <rules>
            <name>WronglyRefundedOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Wrongly refunded</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields8</targetReference>
            </connector>
            <label>Wrongly refunded</label>
        </rules>
        <rules>
            <name>PastDatePNROutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Past Date PNR</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields16</targetReference>
            </connector>
            <label>Past Date PNR</label>
        </rules>
        <rules>
            <name>RefundNotReceivedBOMOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Refund not received</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Not in SRS</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields9</targetReference>
            </connector>
            <label>Refund not received - BOM</label>
        </rules>
        <rules>
            <name>RefundNotReceivedOCOutcome</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Refund not received</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>OK in SRS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>No ticket issued - IBP or RC</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields10</targetReference>
            </connector>
            <label>Refund not received - OC</label>
        </rules>
        <rules>
            <name>RefundNotReceivedDupeOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Refund not received</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Duplicate</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields17</targetReference>
            </connector>
            <label>Refund not received - Duplicate</label>
        </rules>
        <rules>
            <name>RefundNotReceivedDocsOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Refund not received</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>SelectedSubCategory</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Already sent documentation for waiver</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields11</targetReference>
            </connector>
            <label>Refund not received - Docs</label>
        </rules>
        <rules>
            <name>ReservedAmountOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Reserved Amount</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields12</targetReference>
            </connector>
            <label>Reserved amount</label>
        </rules>
        <rules>
            <name>GiftCardOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Gift Card</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields13</targetReference>
            </connector>
            <label>Gift Card</label>
        </rules>
        <rules>
            <name>PassengerBankDetailsOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Passenger bank details</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields14</targetReference>
            </connector>
            <label>Passenger Bank Details</label>
        </rules>
        <rules>
            <name>VoucherOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedRequestType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Voucher</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetCaseFields15</targetReference>
            </connector>
            <label>Voucher</label>
        </rules>
    </decisions>
    <dynamicChoiceSets>
        <name>RefundMacroPicklistChoices</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Refund_Macro__c</picklistField>
        <picklistObject>Refund_Request__c</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <name>emailValidation</name>
        <dataType>Boolean</dataType>
        <expression>REGEX ( UPPER ( {!providedEmail} ) ,&quot;^[A-Z0-9._%+-/!#$%&amp;&apos;*=?^_`{|}~]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$&quot;)</expression>
    </formulas>
    <interviewLabel>New Refund Request {!$Flow.CurrentDateTime}</interviewLabel>
    <label>New Refund Request</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Refund_Request</name>
        <label>Create Refund Request</label>
        <locationX>2294</locationX>
        <locationY>1094</locationY>
        <connector>
            <targetReference>Get_Created_Refund_Request</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Refund_Request_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Country_of_Purchase__c</field>
            <value>
                <elementReference>CountryOfPurchase</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email__c</field>
            <value>
                <elementReference>providedEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Note__c</field>
            <value>
                <elementReference>Note</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PNR__c</field>
            <value>
                <elementReference>PNR</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Phone__c</field>
            <value>
                <elementReference>CustomerPhoneNumber</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Request_Type_Sub_Category__c</field>
            <value>
                <elementReference>SelectedSubCategory</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Request_Type__c</field>
            <value>
                <elementReference>SelectedRequestType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ticket_Numbers__c</field>
            <value>
                <elementReference>TicketNumbers</elementReference>
            </value>
        </inputAssignments>
        <object>Refund_Request__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>CreateRefundCase</name>
        <label>Create Refund Case</label>
        <locationX>2294</locationX>
        <locationY>1334</locationY>
        <connector>
            <targetReference>Success</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Refund_Case_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Department__c</field>
            <value>
                <stringValue>Refunds</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <elementReference>Note</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Initially_Provided_PNR__c</field>
            <value>
                <elementReference>Get_Created_Refund_Request.PNR__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Origin</field>
            <value>
                <stringValue>Internal - New Refund Request Form</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>GetRefundsQueueId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>GetRefundsRecordType.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Request__c</field>
            <value>
                <elementReference>Get_Created_Refund_Request.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <stringValue>Refund Request Form</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SuppliedEmail</field>
            <value>
                <elementReference>providedEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SuppliedPhone</field>
            <value>
                <elementReference>CustomerPhoneNumber</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Team__c</field>
            <value>
                <elementReference>TeamToSet</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Created_Refund_Request</name>
        <label>Get Created Refund Request</label>
        <locationX>2294</locationX>
        <locationY>1214</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateRefundCase</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>PNR__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>PNR</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Refund_Request__c</object>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetRefundsQueueId</name>
        <label>Get Refunds Queue Id</label>
        <locationX>3944</locationX>
        <locationY>278</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_email_to_validate</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Refunds</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetRefundsRecordType</name>
        <label>GetRefundsRecordType</label>
        <locationX>2294</locationX>
        <locationY>638</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SetTeamAndCaseReason</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Channel</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Invalid_Input</name>
        <label>Invalid Input</label>
        <locationX>5330</locationX>
        <locationY>638</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Assign_email_to_validate_0</targetReference>
        </connector>
        <fields>
            <name>ErrorMessage</name>
            <fieldText>&lt;p&gt;{!providedEmail} is not a valid email address and the Refund Request cannot be created.&lt;/p&gt;&lt;p&gt;Please enter a valid email address in order to create the refund request.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>ValidEmail</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Valid Email</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>NewRefundRequest</name>
        <label>New Refund Request</label>
        <locationX>3944</locationX>
        <locationY>158</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>GetRefundsQueueId</targetReference>
        </connector>
        <fields>
            <name>NewRefundRequest_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>NewRefundRequest_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>PNR</name>
                    <dataType>String</dataType>
                    <fieldText>PNR</fieldText>
                    <fieldType>InputField</fieldType>
                    <helpText>&lt;p&gt;The booking&apos;s PNR. If you have multiple, create multiple refund requests. If one isn&apos;t available, enter six dashes ------.&lt;/p&gt;</helpText>
                    <isRequired>true</isRequired>
                    <validationRule>
                        <errorMessage>&lt;p&gt;PNR should be six characters long. If one isn&apos;t applicable, enter six dashes ------. &lt;/p&gt;</errorMessage>
                        <formulaExpression>LEN({!PNR}) = 6</formulaExpression>
                    </validationRule>
                </fields>
                <fields>
                    <name>TicketNumbers</name>
                    <fieldText>Ticket numbers</fieldText>
                    <fieldType>LargeTextArea</fieldType>
                    <helpText>&lt;p&gt;One per line&lt;/p&gt;</helpText>
                    <isRequired>false</isRequired>
                </fields>
                <fields>
                    <name>CountryOfPurchase</name>
                    <dataType>String</dataType>
                    <fieldText>Country of purchase</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <fields>
            <name>CustomerEmail</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Customer&apos;s Email</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>disabled</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>NewRefundRequest_Section2</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>NewRefundRequest_Section2_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>CustomerPhoneNumber</name>
                    <dataType>String</dataType>
                    <fieldText>Customer&apos;s phone number</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <fields>
            <name>RequestType</name>
            <extensionName>flowruntime:dependentPicklists</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>dependencyWrapperApiName</name>
                <value>
                    <stringValue>Refund_Request__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>topPicklistApiName</name>
                <value>
                    <stringValue>Request_Type__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>middlePicklistApiName</name>
                <value>
                    <stringValue>Request_Type_Sub_Category__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>topLabel</name>
                <value>
                    <stringValue>Request Type</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>topRequired</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>middleLabel</name>
                <value>
                    <stringValue>Request Sub Category</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>middleRequired</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>SelectedRequestType</assignToReference>
                <name>topValue</name>
            </outputParameters>
            <outputParameters>
                <assignToReference>SelectedSubCategory</assignToReference>
                <name>middleValue</name>
            </outputParameters>
        </fields>
        <fields>
            <name>Note</name>
            <fieldText>Note</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <helpText>&lt;p&gt;Add each passenger on a separate line&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Refund_Case_Error</name>
        <label>Refund Case Error</label>
        <locationX>4802</locationX>
        <locationY>1454</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>faultMessage</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0); font-family: &amp;quot;Segoe UI VSS (Regular)&amp;quot;, &amp;quot;Segoe UI&amp;quot;, -apple-system, &amp;quot;system-ui&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Ubuntu, Arial, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Case cannot be created. There has been the below error:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;{!$Flow.FaultMessage}&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Please click on &quot;previous&quot; to correct the error and try again.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;If you cannot correct the error, please report the error using the Functional Product Support button.​&lt;/em&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Refund_Request_Error</name>
        <label>Refund Request Error</label>
        <locationX>5066</locationX>
        <locationY>1214</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>Fault_Message</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0); font-family: &amp;quot;Segoe UI VSS (Regular)&amp;quot;, &amp;quot;Segoe UI&amp;quot;, -apple-system, &amp;quot;system-ui&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Ubuntu, Arial, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Request cannot be created. There has been the below error:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;{!$Flow.FaultMessage}&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Please click on &quot;previous&quot; to correct the error and try again.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;If you cannot correct the error, please report the error using the Functional Product Support button.​&lt;/em&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Success</name>
        <label>Success</label>
        <locationX>2294</locationX>
        <locationY>1454</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Minimise_flow_screen</targetReference>
        </connector>
        <fields>
            <name>SuccessText</name>
            <fieldText>&lt;p&gt;Successfully created refund request.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>3818</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>NewRefundRequest</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>providedEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SelectedRequestType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SelectedSubCategory</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>TeamToSet</name>
        <dataType>Picklist</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
